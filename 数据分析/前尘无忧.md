#### 导入所需要的包[¶](#导入所需要的包)

In [1]:

```
import numpy as np
import pandas as pd
import re
import jieba
import warnings
warnings.filterwarnings("ignore")
```

#### 查看数据集[¶](#查看数据集)

In [5]:

```
df = pd.read_csv(r"/home/kesci/input/51job6796/job_info1.csv",encoding='gbk',header=None)
df.sample(10)
```

Out[5]:

|       | 0                                    | 1                                  | 2           | 3            | 4     | 5                                                            | 6                | 7               | 8                                            | 9                                                            |
| ----- | ------------------------------------ | ---------------------------------- | ----------- | ------------ | ----- | ------------------------------------------------------------ | ---------------- | --------------- | -------------------------------------------- | ------------------------------------------------------------ |
| 39672 | 电话风控专员（包住+晋升多+上市企业） | 启涛企业二部                       | 武汉-洪山区 | 0.8-1万/月   | 03-15 | ['武汉-洪山区\xa0\xa0', '\xa0\xa0中技\xa0\xa0', '\xa0...     | ['合资']         | ['1000-5000人'] | ['金融/投资/证券,多元化业务集团公司']        | ['见习风控专员-初级风控专员-中级风控专员-高级风控专员-资深风控专员', '品质管理岗（... |
| 22159 | VR项目经理（内容产品开发）           | 深圳市骄阳数字视觉科技有限责任公司 | 深圳-福田区 | 0.7-1.5万/月 | 03-14 | ['深圳-福田区\xa0\xa0', '\xa0\xa0招2人\xa0\xa0', '\xa...     | ['民营公司']     | ['150-500人']   | ['互联网/电子商务,计算机硬件']               | ['1、参与vr产品开发计划的制定并跟踪执行，保证项目开发的高效进行；', '2、参与VR项... |
| 8196  | 视频编辑                             | 广州善元堂健康科技股份有限公司     | 广州        | 0.8-1万/月   | 03-14 | ['广州\xa0\xa0', '\xa0\xa02年经验\xa0\xa0', '\xa0\x...       | ['民营公司']     | ['150-500人']   | ['制药/生物工程']                            | ['1、负责15秒60秒短视频的策划、拍摄、后期剪辑，包括视频剪辑、特效、音乐、字幕等工作。... |
| 41253 | 综合设备维护                         | 中国电信新疆公司                   | 昌吉        | NaN          | 03-15 | ['昌吉\xa0\xa0', '\xa0\xa0本科\xa0\xa0', '\xa0\xa0...        | ['国企']         | ['']            | ['通信/电信运营、增值服务']                  | []                                                           |
| 32263 | 车管所资料整理员                     | 全洲通大数据科技（武汉）有限公司   | 武汉-武昌区 | 2-3千/月     | 03-14 | ['武汉-武昌区\xa0\xa0', '\xa0\xa0在校生/应届生\xa0\xa0', ... | ['民营公司']     | ['50-150人']    | ['计算机软件']                               | ['工作时间：08:30-17:30（午休1小时）；', '工作周期：长期招聘，双休；', ... |
| 50182 | 人事行政主管                         | 佛山卡丝生物科技有限公司           | 佛山-南海区 | 6-8千/月     | 03-15 | ['佛山-南海区\xa0\xa0', '\xa0\xa0招若干人\xa0\xa0', '\x...   | ['民营公司']     | ['50-150人']    | ['快速消费品(食品、饮料、化妆品),批发/零售'] | []                                                           |
| 25036 | 算法实习生                           | 上海联泰科技股份有限公司           | 上海-松江区 | 4.5-6千/月   | 03-14 | ['上海-松江区\xa0\xa0', '\xa0\xa0在校生/应届生\xa0\xa0', ... | ['合资']         | ['150-500人']   | ['机械/设备/重工']                           | ['岗位职责：', '岗位要求：']                                 |
| 48406 | Java开发工程师-上海浦东-05235        | 博彦科技股份有限公司               | 上海        | 0.8-1.3万/月 | 03-15 | ['上海\xa0\xa0', '\xa0\xa03-4年经验\xa0\xa0', '\xa0...       | ['外资（欧美）'] | ['10000人以上'] | ['计算机软件,通信/电信/网络设备']            | []                                                           |
| 14145 | Java高级开发工程师（智能化）         | 深圳视昀智云科技有限公司           | 深圳-南山区 | 2-2.5万/月   | 03-14 | ['深圳-南山区\xa0\xa0', '\xa0\xa05-7年经验\xa0\xa0', '...    | ['民营公司']     | ['少于50人']    | ['计算机软件,建筑/建材/工程']                | ['1、配合项目经理完成项目开发任务，负责系统平台的架构设计、核心业务逻辑的确定和核心代码的... |
| 34639 | 汉口浦发银行档案整理员               | 全洲通大数据科技（武汉）有限公司   | 武汉-江岸区 | 120元/天     | 03-14 | ['武汉-江岸区\xa0\xa0', '\xa0\xa0在校生/应届生\xa0\xa0', ... | ['民营公司']     | ['50-150人']    | ['计算机软件']                               | ['【岗位】档案整理员（非正编工作）', '【工作内容】内部纸质资料整理（纯文职）', '【... |

#### 处理数据框[¶](#处理数据框)

In [6]:

```
# 为数据框指定行索引
df.index = range(len(df))
# 为数据框指定列索引
df.columns = ["岗位名","公司名","工作地点","工资","发布日期","经验与学历","公司类型","公司规模","行业","工作描述"]
df.head(10)
```

Out[6]:

|      | 岗位名                                    | 公司名                       | 工作地点      | 工资         | 发布日期 | 经验与学历                                                   | 公司类型           | 公司规模         | 行业                                       | 工作描述                                                     |
| ---- | ----------------------------------------- | ---------------------------- | ------------- | ------------ | -------- | ------------------------------------------------------------ | ------------------ | ---------------- | ------------------------------------------ | ------------------------------------------------------------ |
| 0    | 数据岗（优秀应届毕业生）                  | 深圳市保利房地产开发有限公司 | 深圳-福田区   | 0.8-1万/月   | 3月14日  | ['深圳-福田区\xa0\xa0', '\xa0\xa0在校生/应届生\xa0\xa0', ... | ['国企']           | ['150-500人']    | ['房地产']                                 | ['岗位职责：', '1、根据领导指示，对接置业总部上报各类营销报表；', '2、对内定期收... |
| 1    | 大数据开发工程师                          | 网宿科技股份有限公司         | 厦门          | 20-30万/年   | 3月14日  | ['厦门\xa0\xa0', '\xa0\xa05-7年经验\xa0\xa0', '\xa0...       | ['上市公司']       | ['1000-5000人']  | ['通信/电信/网络设备,互联网/电子商务']     | ['岗位职责：', '1.负责公司业务相关的数据统计和分析的设计开发；', '2.负责对业务... |
| 2    | 数据仓库工程师                            | 金蝶软件（中国）有限公司     | 深圳-南山区   | 1-1.5万/月   | 3月14日  | ['深圳-南山区\xa0\xa0', '\xa0\xa03-4年经验\xa0\xa0', '...    | ['外资（非欧美）'] | ['5000-10000人'] | ['计算机软件,互联网/电子商务']             | ['职位职责']                                                 |
| 3    | 数据企划专员                              | 无锡贝贝帕克文化创意有限公司 | 无锡          | NaN          | 3月14日  | ['无锡\xa0\xa0', '\xa0\xa0本科\xa0\xa0', '\xa0\xa0...        | ['民营公司']       | ['']             | ['服装/纺织/皮革']                         | ['（一） 协助商品部门完成他们提出数据调研； （二）完成单品企划模型，发现规划外的产品机会... |
| 4    | 高级大数据产品架构师(J10824)              | 中移（苏州）软件技术有限公司 | 苏州-高新区   | 2.5-3万/月   | 3月14日  | ['苏州-高新区\xa0\xa0', '\xa0\xa05-7年经验\xa0\xa0', '...    | ['国企']           | ['1000-5000人']  | ['计算机软件']                             | ['工作职责:', '1.从事移动云大数据产品架构设计工作；', '2.负责基于开源生态的移... |
| 5    | 数据专员（供应链管理部）                  | 中顺洁柔纸业股份有限公司     | 中山          | 3.5-4.5千/月 | 3月14日  | ['中山\xa0\xa0', '\xa0\xa02年经验\xa0\xa0', '\xa0\x...       | ['上市公司']       | ['5000-10000人'] | ['印刷/包装/造纸']                         | ['任职要求：', '1． 全日制本科及以上学历，统计、会计、物流等与供应链相关专业优先；'... |
| 6    | AI或数据挖掘岗                            | 卓望信息技术（北京）有限公司 | 北京          | NaN          | 3月14日  | ['北京\xa0\xa0', '\xa0\xa0本科\xa0\xa0', '\xa0\xa0...        | ['外资（非欧美）'] | ['']             | ['计算机服务(系统、数据服务、维修)']       | ['工作内容：\xa0', '1、根据数据特点选择合适的算法模型；\xa0', '2、使用t... |
| 7    | 索尼画像数据标注人员                      | 文思海辉技术有限公司         | 无锡          | NaN          | 3月14日  | ['无锡\xa0\xa0', '\xa0\xa0本科\xa0\xa0', '\xa0\xa0...        | ['国企']           | ['']             | ['计算机软件']                             | ['职位描述：\xa0', '负责画像数据的标注，整理，质检\xa0', '职位要求：\xa... |
| 8    | 销售专员（精准数据/无责底薪/旺季高提成）R | 深圳市升学文化传播有限公司   | 广州-天河区   | 6-8千/月     | 3月14日  | ['广州-天河区\xa0\xa0', '\xa0\xa0无需经验\xa0\xa0', '\x...   | ['民营公司']       | ['1000-5000人']  | ['教育/培训/院校,学术/科研']               | ['：', '升学教育集团的服务涵盖了', '等学历提升自学和考前培训。经过8年的沉淀与发展... |
| 9    | 数据专员（财务助理）                      | 广东五福教育科技有限公司     | 东莞-松山湖区 | 4.5-6千/月   | 3月14日  | ['东莞-松山湖区\xa0\xa0', '\xa0\xa01年经验\xa0\xa0', '\...   | ['民营公司']       | ['150-500人']    | ['教育/培训/院校,影视/媒体/艺术/文化传播'] | ['任职要求：', '1、心态良好，细心，耐心； 2、负责数据管理工作； 3、协助经理工作、... |

#### 数据去重[¶](#数据去重)

In [7]:

```
# 数据去重，如果一个行业的公司名和发布的岗位名一致，我们认为是重复值，因此去除掉。
print("去重之前的记录数",df.shape)
df.drop_duplicates(subset=["公司名","岗位名"],inplace=True)
print("去重之后的记录数",df.shape)
去重之前的记录数 (50852, 10)
去重之后的记录数 (36328, 10)
```

#### 岗位名字段处理[¶](#岗位名字段处理)

##### 岗位名的探索[¶](#岗位名的探索)

In [8]:

```
df["岗位名"].value_counts()
df["岗位名"] = df["岗位名"].apply(lambda x:x.lower())
df["岗位名"]
```

Out[8]:

```
0                      数据岗（优秀应届毕业生）
1                          大数据开发工程师
2                           数据仓库工程师
3                            数据企划专员
4                高级大数据产品架构师(j10824)
5                      数据专员（供应链管理部）
6                          ai或数据挖掘岗
7                        索尼画像数据标注人员
8            销售专员（精准数据/无责底薪/旺季高提成）r
9                        数据专员（财务助理）
10                            数据统计员
11                 成本管控与数据专员（地点：启东）
12                           数据产品经理
13                         大数据开发工程师
14                   数据跟单员（6k+周末双休）
15                        医疗数据运维工程师
16                             数据分析
17                        数据文员 朝九晚六
18         大数据开发/数据挖掘/数据分析工程师（人才培养）
19                            数据科学家
20                     数据分析师（精品+急聘）
21                          数据开发工程师
22                           平台数据专员
23                        生物信息数据分析师
24                        金蝶数据开发工程师
25          英语数据业务交付助理_文员客服_8小时白班双休
26                 贷后管理岗（数据分析，内勤正编）
27               猎头顾问（互联网/人工智能/大数据）
28                            大数据运维
29                       数据统计员（偏财务）
                    ...            
50372                           收银员
50373                        安全产品规划
50374       链家房产经纪人+五险+提成+师傅带教+就近安排
50375           z贝壳找房平台房地产销售+高底薪高提成
50376                  z德佑门店销售+置业顾问
50377               z贝壳大平台销售顾问5000+
50378          app 测试工程师 (mj000654)
50379         电话销售：（外包岗） (mj000653)
50380                        天猫运营专员
50381                   运营分析专员（偏财务）
50382                         销售工程师
50383                        渠道销售经理
50384                          销售专员
50385                     shopify运营
50386            销售顾问（六险一金/双休/培训）福永
50387        系统开发工程师（中台） (mj000640)
50388                   产品经理（清洁办公组）
50389                    产品经理（化学品组）
50390                          方案策划
50391                     国际会议和项目专员
50392                        海外媒介专员
50393                    web前端开发工程师
50394               派送/快递专员（银行）就近安排
50395           产品经理（组件） (mj000647)
50396                   java高级开发工程师
50397                   java中级开发工程师
50398                       高级软件工程师
50399                        百度客服经理
50400                       诚聘拼多多运营
50401    贝壳房产经纪人+底薪4000+高提成+五险+就近分配
Name: 岗位名, Length: 36328, dtype: object
```

##### 筛选出我们想要分析的岗位[¶](#筛选出我们想要分析的岗位)

In [9]:

```
target_job = ['算法', '开发', '分析', '工程师', '数据', '运营', '运维']
# 注意count()函数的用法，如果某个岗位名求和大于0，就证明包含了这些关键字字眼。否则就是不包含。
# [df["岗位名"][0].count(i) for i in target_job]   # 结果是[0, 0, 0, 0, 1, 0, 0]。
index = [df["岗位名"].str.count(i) for i in target_job]
index = np.array(index).sum(axis=0) > 0
job_info = df[index]
job_info.shape 
```

Out[9]:

```
(13544, 10)
```

In [10]:

```
job_info.head(5)
```

Out[10]:

|      | 岗位名                       | 公司名                       | 工作地点    | 工资       | 发布日期 | 经验与学历                                                   | 公司类型           | 公司规模         | 行业                                   | 工作描述                                                     |
| ---- | ---------------------------- | ---------------------------- | ----------- | ---------- | -------- | ------------------------------------------------------------ | ------------------ | ---------------- | -------------------------------------- | ------------------------------------------------------------ |
| 0    | 数据岗（优秀应届毕业生）     | 深圳市保利房地产开发有限公司 | 深圳-福田区 | 0.8-1万/月 | 3月14日  | ['深圳-福田区\xa0\xa0', '\xa0\xa0在校生/应届生\xa0\xa0', ... | ['国企']           | ['150-500人']    | ['房地产']                             | ['岗位职责：', '1、根据领导指示，对接置业总部上报各类营销报表；', '2、对内定期收... |
| 1    | 大数据开发工程师             | 网宿科技股份有限公司         | 厦门        | 20-30万/年 | 3月14日  | ['厦门\xa0\xa0', '\xa0\xa05-7年经验\xa0\xa0', '\xa0...       | ['上市公司']       | ['1000-5000人']  | ['通信/电信/网络设备,互联网/电子商务'] | ['岗位职责：', '1.负责公司业务相关的数据统计和分析的设计开发；', '2.负责对业务... |
| 2    | 数据仓库工程师               | 金蝶软件（中国）有限公司     | 深圳-南山区 | 1-1.5万/月 | 3月14日  | ['深圳-南山区\xa0\xa0', '\xa0\xa03-4年经验\xa0\xa0', '...    | ['外资（非欧美）'] | ['5000-10000人'] | ['计算机软件,互联网/电子商务']         | ['职位职责']                                                 |
| 3    | 数据企划专员                 | 无锡贝贝帕克文化创意有限公司 | 无锡        | NaN        | 3月14日  | ['无锡\xa0\xa0', '\xa0\xa0本科\xa0\xa0', '\xa0\xa0...        | ['民营公司']       | ['']             | ['服装/纺织/皮革']                     | ['（一） 协助商品部门完成他们提出数据调研； （二）完成单品企划模型，发现规划外的产品机会... |
| 4    | 高级大数据产品架构师(j10824) | 中移（苏州）软件技术有限公司 | 苏州-高新区 | 2.5-3万/月 | 3月14日  | ['苏州-高新区\xa0\xa0', '\xa0\xa05-7年经验\xa0\xa0', '...    | ['国企']           | ['1000-5000人']  | ['计算机软件']                         | ['工作职责:', '1.从事移动云大数据产品架构设计工作；', '2.负责基于开源生态的移... |

##### 将岗位名称标准化[¶](#将岗位名称标准化)

In [11]:

```
# 将岗位名称标准化：目前岗位名称太多太杂，需要统一
job_list = ['数据分析', "数据统计","数据专员",'数据挖掘', '算法', '大数据',
            '开发工程师', '运营', '软件工程', '前端开发',
            '深度学习', 'ai', '数据库', '数据库', '数据产品',
            '客服', 'java', '.net', 'andrio', '人工智能', 'c++',
            '数据管理',"测试","运维"]
job_list = np.array(job_list)
job_list
```

Out[11]:

```
array(['数据分析', '数据统计', '数据专员', '数据挖掘', '算法', '大数据', '开发工程师', '运营', '软件工程',
       '前端开发', '深度学习', 'ai', '数据库', '数据库', '数据产品', '客服', 'java', '.net',
       'andrio', '人工智能', 'c++', '数据管理', '测试', '运维'], dtype='<U6')
```

In [12]:

```
def rename(x=None,name_list=job_list):
    index = [i in x for i in name_list]
    if sum(index) > 0:
        return name_list[index][0]
    else:
        return x
```

In [13]:

```
job_info["岗位名"] = job_info["岗位名"].apply(rename)
job_info["岗位名"].value_counts()
```

Out[13]:

```
运营                     4446
开发工程师                  1840
数据分析                    789
大数据                     430
运维                      416
软件工程                    384
测试                      322
数据库                     177
java                    165
数据专员                    139
算法                      138
数据统计                     78
数据产品                     55
数据挖掘                     51
质量工程师                    51
数据管理                     50
技术支持工程师                  47
前端开发                     37
销售工程师                    36
网络工程师                    31
软件实施工程师                  31
售前工程师                    29
c++                      27
工艺工程师                    27
电气工程师                    24
it工程师                    23
实施工程师                    23
品质工程师                    23
研发工程师                    22
.net                     20
                       ... 
信息管理工程师                   1
助理项目经理（非标设备开发）            1
广州南沙文员/数据员                1
理化分析工程师(000848)（衡阳）       1
红黄芯片工艺工程师（张家港）            1
中级数据工程师（报表）               1
项目工程师（机械核电方向）             1
售前工程师 技术支持                1
电子失效分析工程师                 1
数据会计                      1
【开发】-产业研究岗                1
检测工程师（危险货物包装检测实验室）        1
电机工程师                     1
嵌入式arm工程师                 1
客户质量工程师                   1
产品开发 （精品）                 1
医药数据系统管理员                 1
云系统集成工程师                  1
pcg19-腾讯视频数据平台后台开发        1
开发经理（嵌入式方向）               1
助理机械工程师                   1
etl developer 数据开发        1
质量工程师(000557)（湘潭）         1
服务工程师（无锡、南京、合肥）           1
对标工程师（产品工程师）              1
软件开发助理                    1
索尼画像数据标注人员                1
弱电系统集成工程师                 1
系统工程师(应届生优先）              1
图像识别工程师                   1
Name: 岗位名, Length: 2785, dtype: int64
```

In [14]:

```
# 数据统计、数据专员、数据分析统一归为数据分析
job_info["岗位名"] = job_info["岗位名"].apply(lambda x:re.sub("数据专员","数据分析",x))
job_info["岗位名"] = job_info["岗位名"].apply(lambda x:re.sub("数据统计","数据分析",x))
```

In [15]:

```
job_s = job_info["岗位名"].value_counts()[:20]
job_s
```

Out[15]:

```
运营         4446
开发工程师      1840
数据分析       1006
大数据         430
运维          416
软件工程        384
测试          322
数据库         177
java        165
算法          138
数据产品         55
数据挖掘         51
质量工程师        51
数据管理         50
技术支持工程师      47
前端开发         37
销售工程师        36
软件实施工程师      31
网络工程师        31
售前工程师        29
Name: 岗位名, dtype: int64
```

##### 绘制岗位柱状图[¶](#绘制岗位柱状图)

In [16]:

```
# 条形图
from pyecharts.charts import Pie,Funnel,Map,Page,Bar,Sankey
from pyecharts import options as opts 
from pyecharts.globals import SymbolType

bar1 = Bar(init_opts=opts.InitOpts(width='700px', height='1000px')) 
bar1.add_xaxis(job_s.index.tolist())
bar1.add_yaxis('', job_s.values.tolist()) 
bar1.set_global_opts(title_opts=opts.TitleOpts(title='岗位数量top20'),
                    )
bar1.set_series_opts(label_opts=opts.LabelOpts(position='right'))
bar1.reversal_axis()
bar1.render_notebook()
```

Out[16]:

#### 工资字段处理[¶](#工资字段处理)

说明：工资数据给出的一般是一个范围，数据也很不标准，例如：“千/月、万/月、万/年”等，下面我们做一个统一后，取数据范围的平均值。
 像结尾是"天"的一般属于兼职，我们也不考虑。直接删除这样的数据。

##### 转化工资[¶](#转化工资)

In [17]:

```
job_info["工资"].str[-1].value_counts()
job_info["工资"].str[-3].value_counts()

index1 = job_info["工资"].str[-1].isin(["年","月"])
index2 = job_info["工资"].str[-3].isin(["万","千"])
job_info = job_info[index1 & index2]
```

In [18]:

```
def get_money_max_min(x):
    try:
        if x[-3] == "万":
            z = [float(i)*10000 for i in re.findall("[0-9]+\.?[0-9]*",x)]
        elif x[-3] == "千":
            z = [float(i) * 1000 for i in re.findall("[0-9]+\.?[0-9]*", x)]
        if x[-1] == "年":
            z = [i/12 for i in z]
        return z
    except:
        return x
```

In [19]:

```
salary = job_info["工资"].apply(get_money_max_min)
salary
```

Out[19]:

```
0                             [8000.0, 10000.0]
1                 [16666.666666666668, 25000.0]
2                            [10000.0, 15000.0]
4                            [25000.0, 30000.0]
5                              [3500.0, 4500.0]
8                              [6000.0, 8000.0]
9                              [4500.0, 6000.0]
10                             [4000.0, 6000.0]
11                            [6000.0, 10000.0]
12                            [8000.0, 15000.0]
13                           [15000.0, 22000.0]
14                             [6000.0, 8000.0]
15                             [4000.0, 6000.0]
16                             [6000.0, 8000.0]
17                             [3500.0, 4000.0]
18                             [4500.0, 6000.0]
19                           [20000.0, 30000.0]
20                            [5000.0, 12000.0]
21                           [15000.0, 20000.0]
22                             [4500.0, 6000.0]
23                            [6000.0, 20000.0]
24                [16666.666666666668, 25000.0]
25                             [4500.0, 6000.0]
26                            [7000.0, 10000.0]
27                [16666.666666666668, 25000.0]
28                            [9000.0, 18000.0]
29                             [4000.0, 5500.0]
30                 [8333.333333333334, 12500.0]
31                            [8000.0, 10000.0]
32                             [4000.0, 6000.0]
                          ...                  
50314                         [6000.0, 12000.0]
50316                        [10000.0, 15000.0]
50319                        [16000.0, 25000.0]
50320                        [10000.0, 15000.0]
50321                        [18000.0, 35000.0]
50322                          [6000.0, 8000.0]
50323                         [9000.0, 15000.0]
50331                         [8000.0, 13000.0]
50336                        [10000.0, 15000.0]
50340                        [10000.0, 20000.0]
50342                        [12000.0, 20000.0]
50343                         [8000.0, 15000.0]
50349              [8333.333333333334, 25000.0]
50353                         [5000.0, 10000.0]
50358                         [8000.0, 10000.0]
50359                        [15000.0, 25000.0]
50363                          [6000.0, 8000.0]
50366                         [8000.0, 10000.0]
50369                          [6000.0, 8000.0]
50378                        [15000.0, 20000.0]
50380                         [6000.0, 15000.0]
50381                         [8000.0, 12000.0]
50382    [6666.666666666667, 8333.333333333334]
50385                        [10000.0, 15000.0]
50387                        [15000.0, 20000.0]
50393                        [10000.0, 15000.0]
50396                        [15000.0, 20000.0]
50397                        [10000.0, 15000.0]
50398                        [20000.0, 30000.0]
50400                         [5000.0, 10000.0]
Name: 工资, Length: 12255, dtype: object
```

In [20]:

```
job_info["最低工资"] = salary.str[0]
job_info["最高工资"] = salary.str[1]
job_info["工资水平"] = job_info[["最低工资","最高工资"]].mean(axis=1)
job_info["工资水平"] = round(job_info["工资水平"],0)
job_info["工资水平"]
```

Out[20]:

```
0         9000.0
1        20833.0
2        12500.0
4        27500.0
5         4000.0
8         7000.0
9         5250.0
10        5000.0
11        8000.0
12       11500.0
13       18500.0
14        7000.0
15        5000.0
16        7000.0
17        3750.0
18        5250.0
19       25000.0
20        8500.0
21       17500.0
22        5250.0
23       13000.0
24       20833.0
25        5250.0
26        8500.0
27       20833.0
28       13500.0
29        4750.0
30       10417.0
31        9000.0
32        5000.0
          ...   
50314     9000.0
50316    12500.0
50319    20500.0
50320    12500.0
50321    26500.0
50322     7000.0
50323    12000.0
50331    10500.0
50336    12500.0
50340    15000.0
50342    16000.0
50343    11500.0
50349    16667.0
50353     7500.0
50358     9000.0
50359    20000.0
50363     7000.0
50366     9000.0
50369     7000.0
50378    17500.0
50380    10500.0
50381    10000.0
50382     7500.0
50385    12500.0
50387    17500.0
50393    12500.0
50396    17500.0
50397    12500.0
50398    25000.0
50400     7500.0
Name: 工资水平, Length: 12255, dtype: float64
```

##### 工资的分布[¶](#工资的分布)

In [21]:

```
def tranform_gz(x):
    if x <= 5000.0:
        return '低于5千/月'
    elif x <= 8000.0:
        return '5千~8千/月'
    elif x <= 10000.0:
        return '8千~1万/月'
    elif x <= 15000:
        return '1万~1万5/月'
    else:
        return '1万5以上/月'
```

In [22]:

```
job_info['分级'] = job_info["工资水平"].apply(lambda x:tranform_gz(x))
gz_score = job_info['分级'].value_counts()
print(gz_score)
5千~8千/月     4570
1万~1万5/月    2834
1万5以上/月     1885
8千~1万/月     1873
低于5千/月      1093
Name: 分级, dtype: int64
```

##### 绘制饼图[¶](#绘制饼图)

In [23]:

```
data_pair =  [list(z) for z in zip(gz_score.index.tolist(), gz_score.values.tolist())]

# 绘制饼图
pie1 = Pie()
pie1.add('', data_pair, radius=['35%', '60%'], rosetype='radius')
pie1.set_global_opts(title_opts=opts.TitleOpts(title='工资分布'), 
                     legend_opts=opts.LegendOpts(orient='vertical', pos_top='15%', pos_left='2%'))
pie1.set_series_opts(label_opts=opts.LabelOpts(formatter="{b}:{d}%"))
pie1.set_colors(['#EF9050', '#3B7BA9', '#6FB27C', '#FFAF34', '#D8BFD8', '#00BFFF'])
pie1.render_notebook()
```

Out[23]:

#### 公司类型字段处理[¶](#公司类型字段处理)

##### 处理公司类型[¶](#处理公司类型)

In [24]:

```
job_info["公司类型"].value_counts()
job_info["公司类型"]
```

Out[24]:

```
0             ['国企']
1           ['上市公司']
2        ['外资（非欧美）']
4             ['国企']
5           ['上市公司']
8           ['民营公司']
9           ['民营公司']
10          ['民营公司']
11          ['民营公司']
12          ['民营公司']
13          ['民营公司']
14          ['民营公司']
15          ['民营公司']
16          ['民营公司']
17          ['民营公司']
18          ['民营公司']
19          ['创业公司']
20          ['民营公司']
21          ['民营公司']
22          ['民营公司']
23          ['民营公司']
24          ['上市公司']
25          ['民营公司']
26          ['上市公司']
27          ['民营公司']
28          ['民营公司']
29          ['民营公司']
30          ['事业单位']
31          ['民营公司']
32            ['国企']
            ...     
50314       ['民营公司']
50316       ['民营公司']
50319       ['民营公司']
50320       ['民营公司']
50321       ['民营公司']
50322       ['民营公司']
50323    ['外资（非欧美）']
50331       ['民营公司']
50336         ['合资']
50340       ['民营公司']
50342         ['国企']
50343         ['国企']
50349       ['民营公司']
50353       ['民营公司']
50358         ['合资']
50359       ['上市公司']
50363       ['民营公司']
50366         ['国企']
50369       ['民营公司']
50378       ['民营公司']
50380       ['民营公司']
50381       ['上市公司']
50382       ['民营公司']
50385       ['民营公司']
50387       ['民营公司']
50393       ['民营公司']
50396       ['创业公司']
50397       ['创业公司']
50398         ['合资']
50400       ['民营公司']
Name: 公司类型, Length: 12255, dtype: object
```

In [25]:

```
job_info.loc[job_info["公司类型"].apply(lambda x:len(x)<6),"公司类型"] = np.nan
job_info["公司类型"] = job_info["公司类型"].str[2:-2]
job_info["公司类型"]
```

Out[25]:

```
0             国企
1           上市公司
2        外资（非欧美）
4             国企
5           上市公司
8           民营公司
9           民营公司
10          民营公司
11          民营公司
12          民营公司
13          民营公司
14          民营公司
15          民营公司
16          民营公司
17          民营公司
18          民营公司
19          创业公司
20          民营公司
21          民营公司
22          民营公司
23          民营公司
24          上市公司
25          民营公司
26          上市公司
27          民营公司
28          民营公司
29          民营公司
30          事业单位
31          民营公司
32            国企
          ...   
50314       民营公司
50316       民营公司
50319       民营公司
50320       民营公司
50321       民营公司
50322       民营公司
50323    外资（非欧美）
50331       民营公司
50336         合资
50340       民营公司
50342         国企
50343         国企
50349       民营公司
50353       民营公司
50358         合资
50359       上市公司
50363       民营公司
50366         国企
50369       民营公司
50378       民营公司
50380       民营公司
50381       上市公司
50382       民营公司
50385       民营公司
50387       民营公司
50393       民营公司
50396       创业公司
50397       创业公司
50398         合资
50400       民营公司
Name: 公司类型, Length: 12255, dtype: object
```

In [26]:

```
gs = job_info["公司类型"].value_counts()
gs
```

Out[26]:

```
民营公司       8642
上市公司        885
国企          818
合资          708
外资（非欧美）     499
外资（欧美）      332
创业公司        234
事业单位         68
非营利组织        25
外企代表处        11
政府机关          3
Name: 公司类型, dtype: int64
```

In [27]:

```
data_pairs =  [list(z) for z in zip(gs.index.tolist(), gs.values.tolist())]
print(data_pairs)
[['民营公司', 8642], ['上市公司', 885], ['国企', 818], ['合资', 708], ['外资（非欧美）', 499], ['外资（欧美）', 332], ['创业公司', 234], ['事业单位', 68], ['非营利组织', 25], ['外企代表处', 11], ['政府机关', 3]]
```

##### 公司类别饼图[¶](#公司类别饼图)

In [28]:

```
# 饼图
pie2 = Pie(init_opts=opts.InitOpts(width='1000px', height='750px'))
# 内置富文本
pie2.add( 
        series_name="sales",
        radius=["35%", "55%"],
        data_pair=data_pairs,
        label_opts=opts.LabelOpts(
            position="outside",
            formatter="{a|{a}}{abg|}\n{hr|}\n {b|{b}: }{c}  {per|{d}%}  ",
            background_color="#eee",
            border_color="#aaa",
            border_width=1,
            border_radius=4,
            rich={
                "a": {"color": "#999", "lineHeight": 22, "align": "center"},
                "abg": {
                    "backgroundColor": "#e3e3e3",
                    "width": "100%",
                    "align": "right",
                    "height": 22,
                    "borderRadius": [4, 4, 0, 0],
                },
                "hr": {
                    "borderColor": "#aaa",
                    "width": "100%",
                    "borderWidth": 0.5,
                    "height": 0,
                },
                "b": {"fontSize": 16, "lineHeight": 33},
                "per": {
                    "color": "#eee",
                    "backgroundColor": "#334455",
                    "padding": [2, 4],
                    "borderRadius": 2,
                },
            },
        ),
)
pie2.set_global_opts(legend_opts=opts.LegendOpts(pos_left="left", pos_top='30%', orient="vertical"), 
                     toolbox_opts=opts.ToolboxOpts(),
                     title_opts=opts.TitleOpts(title='公司类别分布'))
pie2.set_series_opts(
    tooltip_opts=opts.TooltipOpts(trigger="item", formatter="{a} <br/>{b}: {c} ({d}%)")
    )
pie2.render_notebook()
```

Out[28]:

#### 行业字段处理[¶](#行业字段处理)

##### 处理行业分布[¶](#处理行业分布)

In [29]:

```
#说明：每个公司的行业字段可能会有多个行业标签，但是我们默认以第一个作为该公司的行业标签。
job_info["行业"].value_counts()
```

Out[29]:

```
['计算机软件']                        951
['互联网/电子商务']                     820
['计算机软件,计算机服务(系统、数据服务、维修)']      467
['电子技术/半导体/集成电路']                467
['互联网/电子商务,计算机软件']               403
['计算机软件,互联网/电子商务']               361
['贸易/进出口']                       335
['互联网/电子商务,贸易/进出口']              273
['快速消费品(食品、饮料、化妆品)']             191
['制药/生物工程']                      179
['机械/设备/重工']                     173
['教育/培训/院校']                     169
['服装/纺织/皮革']                     156
['金融/投资/证券']                     148
['计算机服务(系统、数据服务、维修)']            142
['计算机服务(系统、数据服务、维修),计算机软件']      133
['贸易/进出口,互联网/电子商务']              128
['专业服务(咨询、人力资源、财会)']             109
['建筑/建材/工程']                     108
['汽车']                           107
['互联网/电子商务,快速消费品(食品、饮料、化妆品)']     91
['医疗设备/器械']                       86
['互联网/电子商务,批发/零售']                86
['房地产']                           86
['通信/电信/网络设备']                    85
['影视/媒体/艺术/文化传播']                 85
['仪器仪表/工业自动化']                    84
['计算机软件,电子技术/半导体/集成电路']           81
['计算机软件,通信/电信/网络设备']              74
['批发/零售']                         71
                                ... 
['新能源,检测，认证']                      1
['教育/培训/院校,医疗设备/器械']               1
['学术/科研,多元化业务集团公司']                1
['文字媒体/出版,批发/零售']                  1
['计算机服务(系统、数据服务、维修),航天/航空']        1
['仪器仪表/工业自动化,教育/培训/院校']            1
['计算机硬件,通信/电信运营、增值服务']             1
['非营利组织,学术/科研']                    1
['环保,批发/零售']                       1
['医疗/护理/卫生,非营利组织']                 1
['批发/零售,计算机服务(系统、数据服务、维修)']        1
['酒店/旅游,航天/航空']                    1
['物业管理/商业中心,公关/市场推广/会展']           1
['检测，认证,航天/航空']                    1
['航天/航空,计算机软件']                    1
['互联网/电子商务,石油/化工/矿产/地质']           1
['服装/纺织/皮革,广告']                    1
['通信/电信运营、增值服务,外包服务']              1
['建筑/建材/工程,计算机硬件']                 1
['检测，认证,学术/科研']                    1
['法律,生活服务']                        1
['生活服务,计算机软件']                     1
['网络游戏,电子技术/半导体/集成电路']             1
['电气/电力/水利,贸易/进出口']                1
['多元化业务集团公司,租赁服务']                 1
['原材料和加工,检测，认证']                   1
['文字媒体/出版,计算机软件']                  1
['影视/媒体/艺术/文化传播,家具/家电/玩具/礼品']      1
['原材料和加工,汽车']                      1
['贸易/进出口,公关/市场推广/会展']              1
Name: 行业, Length: 968, dtype: int64
```

In [30]:

```
job_info["行业"] = job_info["行业"].apply(lambda x:re.sub(",","/",x))
job_info.loc[job_info["行业"].apply(lambda x:len(x)<6),"行业"] = np.nan
job_info["行业"] = job_info["行业"].str[2:-2].str.split("/").str[0]
job_info["行业"]
```

Out[30]:

```
0                     房地产
1                      通信
2                   计算机软件
4                   计算机软件
5                      印刷
8                      教育
9                      教育
10              多元化业务集团公司
11                     机械
12                     电气
13                  计算机软件
14                     金融
15                     医疗
16                    互联网
17                   医疗设备
18                    互联网
19                  计算机软件
20                    互联网
21                    互联网
22                     汽车
23                     学术
24                   仪器仪表
25                    互联网
26                     金融
27                    互联网
28                  计算机软件
29                    房地产
30                     学术
31                     服装
32                     影视
               ...       
50314                医疗设备
50316    专业服务(咨询、人力资源、财会)
50319                 房地产
50320                 奢侈品
50321                 互联网
50322                  制药
50323               计算机软件
50331               计算机软件
50336                物业管理
50340                 互联网
50342                  建筑
50343                  建筑
50349                  电气
50353                仪器仪表
50358               计算机硬件
50359                  教育
50363                 互联网
50366                电子技术
50369               计算机软件
50378                 互联网
50380    快速消费品(食品、饮料、化妆品)
50381                  通信
50382                 新能源
50385                 互联网
50387                 互联网
50393                网络游戏
50396               计算机软件
50397               计算机软件
50398                电子技术
50400                 互联网
Name: 行业, Length: 12255, dtype: object
```

In [31]:

```
hy = job_info["行业"].value_counts()[:20]
hy
```

Out[31]:

```
计算机软件                2243
互联网                  2230
电子技术                  786
贸易                    674
计算机服务(系统、数据服务、维修)     595
通信                    430
快速消费品(食品、饮料、化妆品)      362
机械                    328
仪器仪表                  283
服装                    280
教育                    273
制药                    272
建筑                    244
金融                    243
专业服务(咨询、人力资源、财会)      200
汽车                    192
批发                    192
医疗设备                  167
房地产                   152
影视                    142
Name: 行业, dtype: int64
```

##### 前20个行业招聘人数饼图[¶](#前20个行业招聘人数饼图)

In [32]:

```
data_pairss =  [list(z) for z in zip(hy.index.tolist(), hy.values.tolist())]
print(data_pairss)
[['计算机软件', 2243], ['互联网', 2230], ['电子技术', 786], ['贸易', 674], ['计算机服务(系统、数据服务、维修)', 595], ['通信', 430], ['快速消费品(食品、饮料、化妆品)', 362], ['机械', 328], ['仪器仪表', 283], ['服装', 280], ['教育', 273], ['制药', 272], ['建筑', 244], ['金融', 243], ['专业服务(咨询、人力资源、财会)', 200], ['汽车', 192], ['批发', 192], ['医疗设备', 167], ['房地产', 152], ['影视', 142]]
```

In [33]:

```
pie3 = Pie(init_opts=opts.InitOpts(width='1000px', height='750px'))
# 内置富文本
pie3.add( 
        series_name="sales",
        radius=["35%", "55%"],
        data_pair=data_pairss,
        label_opts=opts.LabelOpts(
            position="outside",
            formatter="{a|{a}}{abg|}\n{hr|}\n {b|{b}: }{c}  {per|{d}%}  ",
            background_color="#eee",
            border_color="#aaa",
            border_width=1,
            border_radius=4,
            rich={
                "a": {"color": "#999", "lineHeight": 22, "align": "center"},
                "abg": {
                    "backgroundColor": "#e3e3e3",
                    "width": "100%",
                    "align": "right",
                    "height": 22,
                    "borderRadius": [4, 4, 0, 0],
                },
                "hr": {
                    "borderColor": "#aaa",
                    "width": "100%",
                    "borderWidth": 0.5,
                    "height": 0,
                },
                "b": {"fontSize": 16, "lineHeight": 33},
                "per": {
                    "color": "#eee",
                    "backgroundColor": "#334455",
                    "padding": [2, 4],
                    "borderRadius": 2,
                },
            },
        ),
)
pie3.set_global_opts(legend_opts=opts.LegendOpts(pos_left="right", pos_top='30%', orient="vertical"), 
                     toolbox_opts=opts.ToolboxOpts(),
                     title_opts=opts.TitleOpts(title='前20个行业职位数量分布'))
pie3.set_series_opts(
    tooltip_opts=opts.TooltipOpts(trigger="item", formatter="{a} <br/>{b}: {c} ({d}%)")
    )
pie3.render_notebook()
```

Out[33]:

#### 公司规模字段处理[¶](#公司规模字段处理)

##### 公司规模[¶](#公司规模)

In [34]:

```
# 通过value_counts()函数可以看出，公司规模字段共有八种情况
job_info["公司规模"].value_counts()
job_info["公司规模"]
```

Out[34]:

```
0           ['150-500人']
1         ['1000-5000人']
2        ['5000-10000人']
4         ['1000-5000人']
5        ['5000-10000人']
8         ['1000-5000人']
9           ['150-500人']
10          ['150-500人']
11          ['150-500人']
12          ['150-500人']
13           ['50-150人']
14         ['500-1000人']
15           ['50-150人']
16           ['50-150人']
17          ['150-500人']
18           ['50-150人']
19             ['少于50人']
20           ['50-150人']
21           ['50-150人']
22           ['50-150人']
23             ['少于50人']
24         ['500-1000人']
25             ['少于50人']
26        ['1000-5000人']
27             ['少于50人']
28       ['5000-10000人']
29        ['1000-5000人']
30          ['150-500人']
31         ['500-1000人']
32           ['50-150人']
              ...       
50314       ['150-500人']
50316          ['少于50人']
50319        ['50-150人']
50320       ['150-500人']
50321      ['500-1000人']
50322       ['150-500人']
50323     ['1000-5000人']
50331        ['50-150人']
50336    ['5000-10000人']
50340       ['150-500人']
50342       ['150-500人']
50343       ['150-500人']
50349       ['150-500人']
50353          ['少于50人']
50358     ['1000-5000人']
50359       ['150-500人']
50363          ['少于50人']
50366       ['150-500人']
50369      ['500-1000人']
50378      ['500-1000人']
50380        ['50-150人']
50381     ['1000-5000人']
50382          ['少于50人']
50385       ['150-500人']
50387      ['500-1000人']
50393       ['150-500人']
50396          ['少于50人']
50397          ['少于50人']
50398       ['150-500人']
50400          ['少于50人']
Name: 公司规模, Length: 12255, dtype: object
```

In [35]:

```
def func(x):
    if x == "['少于50人']":
        return "<50"
    elif x == "['50-150人']":
        return "50-150"
    elif x == "['150-500人']":
        return '150-500'
    elif x == "['500-1000人']":
        return '500-1000'
    elif x == "['1000-5000人']":
        return '1000-5000'
    elif x == "['5000-10000人']":
        return '5000-10000'
    elif x == "['10000人以上']":
        return ">10000"
    else:
        return np.nan
job_info["公司规模"] = job_info["公司规模"].apply(func)
job_info["公司规模"]
```

Out[35]:

```
0           150-500
1         1000-5000
2        5000-10000
4         1000-5000
5        5000-10000
8         1000-5000
9           150-500
10          150-500
11          150-500
12          150-500
13           50-150
14         500-1000
15           50-150
16           50-150
17          150-500
18           50-150
19              <50
20           50-150
21           50-150
22           50-150
23              <50
24         500-1000
25              <50
26        1000-5000
27              <50
28       5000-10000
29        1000-5000
30          150-500
31         500-1000
32           50-150
            ...    
50314       150-500
50316           <50
50319        50-150
50320       150-500
50321      500-1000
50322       150-500
50323     1000-5000
50331        50-150
50336    5000-10000
50340       150-500
50342       150-500
50343       150-500
50349       150-500
50353           <50
50358     1000-5000
50359       150-500
50363           <50
50366       150-500
50369      500-1000
50378      500-1000
50380        50-150
50381     1000-5000
50382           <50
50385       150-500
50387      500-1000
50393       150-500
50396           <50
50397           <50
50398       150-500
50400           <50
Name: 公司规模, Length: 12255, dtype: object
```

In [36]:

```
gm = job_info["公司规模"].value_counts()
gm
```

Out[36]:

```
50-150        3711
150-500       2828
<50           2434
1000-5000     1106
500-1000      1022
>10000         547
5000-10000     241
Name: 公司规模, dtype: int64
```

##### 规模分布[¶](#规模分布)

In [37]:

```
data_pairsss =  [list(z) for z in zip(gm.index.tolist(), gm.values.tolist())]

# 绘制饼图
pie4 = Pie()
pie4.add('', data_pairsss, radius=['35%', '60%'], rosetype='radius')
pie4.set_global_opts(title_opts=opts.TitleOpts(title='公司规模'), 
                     legend_opts=opts.LegendOpts(orient='vertical', pos_top='15%', pos_left='2%'))
pie4.set_series_opts(label_opts=opts.LabelOpts(formatter="{b}:{d}%"))
pie4.set_colors(['#EF9050', '#3B7BA9', '#6FB27C', '#FFAF34', '#D8BFD8', '#00BFFF'])
pie4.render_notebook()
```

Out[37]:

其他项目：
[【Python课程哪家强】数据分析腾讯课堂python课程](https://www.kesci.com/mw/project/5fc90db46571040030a5554c)
[漫客栈全类型漫画爬取（3000部漫画）](https://www.kesci.com/mw/project/5fb11da37d1e6d0030d849b1)
[B站一哥老番茄近期100个视频信息](https://www.kesci.com/mw/project/5faeaa587d1e6d0030d6e938/)
[/B站打工人视频分析](https://www.kesci.com/mw/project/5fa7f3e249c6d70030ef43bd)
[B站播放量TOP15的桑基图](https://www.kesci.com/mw/project/5f4f41cb545ba80031b5185b)
[全国复工后电影票房](https://www.kesci.com/mw/project/5f4bab096476cf0036f8107b)
[去哪儿网2020年五一假期出游可视化](https://www.kesci.com/mw/project/5f4923e25c4b5d0036385e74)
[可视化国内微信公众号的情况](https://www.kesci.com/mw/project/5f44c4a1835fe7002d98eabc)

In [ ]:

```

```